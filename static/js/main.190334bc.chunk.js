(this["webpackJsonpreact-conway"]=this["webpackJsonpreact-conway"]||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(5),o=n.n(c),s=(n(13),n(1));var i=function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=e}),[e]),Object(r.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])};n(14);var u=function(){var e="object"===typeof window,t=Object(r.useCallback)((function(){return{width:e?window.innerWidth:void 0,height:e?window.innerHeight:void 0}}),[e]),n=Object(r.useState)(t),a=Object(s.a)(n,2),c=a[0],o=a[1];return Object(r.useEffect)((function(){if(!e)return!1;function n(){o(t())}return window.addEventListener("resize",n),function(){return window.removeEventListener("resize",n)}}),[t,e]),c},l=n(2),d=function(e,t){return{x:e%t,y:Math.floor(e/t)}},f=function(e,t){var n=e.x;return e.y*t+n},b=function(e,t,n){return((e+t)%(r=n)+r)%r;var r},v=function(e,t,n,r,a){var c=r-t,o=a-n,s=Object(l.a)(e);return c>0?s=function(e,t,n,r){for(var a=r-t,c=1;c<=n;c++){var o=(c-1)*a,s=c*t;e.splice.apply(e,[o+s,0].concat(Object(l.a)(Array(a).fill(0))))}return e}(e,t,n,r):c<0&&(s=function(e,t,n,r){for(var a=Math.abs(r-t),c=1;c<=n;c++){var o=c*r;e.splice(o,a)}return e}(e,t,n,r)),o>0?s=function(e,t,n,r){var a=r-n;return[].concat(Object(l.a)(e),Object(l.a)(Array(a*t).fill(0)))}(s,r,n,a):o<0&&(s=function(e,t,n,r){return e.slice(0,t*r)}(s,r,0,a)),s},h=function(e,t,n,r,a){for(var c=e.x,o=e.y,i=a.distanceVec,u=Object(l.a)(t),d=new Set,v=0,h=i.length;v<h;v++)if(1===a.template[v]){var m=Object(s.a)(i[v],2),w=m[0],p=m[1],g=f({x:b(c,w,n),y:b(o,p,r)},n);u[g]=a.template[v],d.add(g)}return{nBoard:u,paintedIndices:d}},m=function(e,t,n,r){for(var a=e.x,c=e.y,o=0,i=0,u=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];i<u.length;i++){var l=Object(s.a)(u[i],2),d=l[0],v=l[1],h=b(a,d,n),m=b(c,v,r);1===t[f({x:h,y:m},n)]&&(o+=1)}return o};function w(e,t,n){var a=Object(r.useState)(n),c=Object(s.a)(a,2),o=c[0],i=c[1],u=Object(r.useState)(!1),f=Object(s.a)(u,2),b=f[0],v=f[1];return[o,i,b,v,function(){for(var n=Object(l.a)(o),r=0,a=o.length;r<a;r++){var c=d(r,t),s=m(c,o,t,e);1===o[r]?(s<2||s>3)&&(n[r]=0):3===s&&(n[r]=1)}i(n),function(e){return e.every((function(e){return 0===e}))}(n)&&v(!1)}]}var p=n(7),g=n(3),j=n.n(g),y=n(6),O=function(e,t){for(var n,r,a=0,c=/#([CcNOPrR]).*/gm,o=[];null!==(n=c.exec(t));)n.index===c.lastIndex&&c.lastIndex++,o.push(n[0]),a=c.lastIndex;try{return r=o[0].split("#N ")[1],e.name=r,e.displayName=r,++a}catch(s){console.log(s),console.log(t)}},E=function(e,t,n){var r,a=/^x.+/gm;a.lastIndex=n;for(var c=[];null!==(r=a.exec(t));)r.index===a.lastIndex&&a.lastIndex++,c.push(r[0]),n=a.lastIndex;var o=c[0].split(", "),i=Object(s.a)(o,2),u=i[0],l=i[1];return e.cols=parseInt(u.split(" = ")[1]),e.rows=parseInt(l.split(" = ")[1]),++n},k=function(e,t,n){for(var r,a=e.cols*e.rows,c=new Uint8Array(a),o=0,s=1,i=!1,u=0,l=t.length;n<l;n++)if((r=t.charCodeAt(n))>=48&&r<=57)i?(s*=10,s+=48^r):(s=48^r,i=!0);else{if(98===r)o+=s,u+=s;else if(r>=65&&r<=90||r>=97&&r<122)for(u+=s;s--;)c[o]=1,o++;else if(36===r)u<e.cols&&(o+=e.cols-u),s-1&&(o+=(s-1)*e.cols),u=0;else if(33===r)break;s=1,i=!1}e.template=c};function S(){return(S=Object(y.a)(j.a.mark((function e(t){var n,r,a,c,o,s,i,u,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:n=e.sent,r=new TextDecoder("utf-8"),a=n.body.getReader(),c="",o={};case 7:return e.next=10,a.read();case 10:if(s=e.sent,i=s.done,u=s.value,!i){e.next=15;break}return e.abrupt("break",18);case 15:c+=r.decode(u),e.next=7;break;case 18:return l=O(o,c),l=E(o,c,l),k(o,c,l),e.abrupt("return",o);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=function(e){for(var t=e.rows,n=e.cols,r=function(e){var t=e.rows,n=e.cols;return{x:Math.floor((n-1)/2),y:Math.floor((t-1)/2)}}({rows:t,cols:n}),a=r.x,c=r.y,o=Array(t*n),s=0,i=t*n;s<i;s++){var u=d(s,n),l=u.x,f=u.y;o[s]=[l-a,f-c]}return o},I=function(e){var t=function(e){for(var t=e.template,n=e.rows,r=e.cols,a=Array(n*r),c=0,o=r-1;o>=0;o--)for(var s=0;s<n;s++){var i=f({x:o,y:s},r);a[c]=t[i],c++}return{template:a,rows:r,cols:n}}(e);return Object(p.a)({},e,{},t,{distanceVec:x(t)})},B={name:"Glider",displayName:"Glider",rows:3,cols:3,template:[0,1,0,0,0,1,1,1,1],distanceVec:x({cols:3,rows:3})},C=["bigun.rle","crab.rle","glider.rle","glidertrain.rle","gosperglider.rle","hwss.rle","inlineinverter.rle","jaydot.rle","loafer.rle","lobster.rle","newgun2.rle","nms.rle","pixel.rle","rabbits.rle","simkinglider.rle","spacerake.rle","spider.rle","twogun.rle","wing.rle"];function R(e,t){var n=Object(r.useState)([]),a=Object(s.a)(n,2),c=a[0],o=a[1],i=Object(r.useState)(!1),u=Object(s.a)(i,2),l=u[0],d=u[1],f=Object(r.useState)([]),b=Object(s.a)(f,2),v=b[0],h=b[1];return Object(r.useEffect)((function(){Promise.all(C.map((function(e){return function(e){return S.apply(this,arguments)}("/react-conway/patterns/"+e)}))).then((function(e){d(!0),o(e)}))}),[]),Object(r.useEffect)((function(){var n=c.filter((function(n){return n.cols<=e&&n.rows<=t}));h(n)}),[e,t,c]),[v,l]}function N(e){var t=e.onChange,n=e.selectedBrush,r=e.brushesLoaded,c=e.brushes;return r?a.a.createElement("select",{className:"select",value:n.name,onChange:t},c.map((function(e){return a.a.createElement("option",{key:e.name,value:e.name},e.displayName)}))):a.a.createElement("div",null,"loading")}function L(e){var t=e.advanceBoard,n=e.toggleIsRunning,c=e.isRunning,o=e.setIsRunning,i=e.setBoard,u=e.board,d=e.setSelectedBrushWrapper,f=e.selectedBrush,b=e.touchHoverClear,v=e.setLastPaintedIndices,h=R(e.cols,e.rows),m=Object(s.a)(h,2),w=m[0],p=m[1],g=Object(r.useCallback)((function(e){"KeyE"!==e.code&&"click"!==e.type||(o(!1),i(Object(l.a)(u).fill(0)),v(new Set))}),[o,i,u,v]);Object(r.useEffect)((function(){return document.addEventListener("keydown",g,!1),function(){document.removeEventListener("keydown",g,!1)}}),[g]);var j=Object(r.useCallback)((function(e){"KeyW"!==e.code&&"click"!==e.type||(v(new Set),o(!1),t())}),[o,t,v]);return Object(r.useEffect)((function(){return document.addEventListener("keydown",j,!1),function(){document.removeEventListener("keydown",j,!1)}}),[j]),a.a.createElement("div",{className:"controls"},a.a.createElement("button",{className:"button",onTouchStart:b,onClick:function(){o(!1),t()}},"Next ",a.a.createElement("span",{className:"button__shortcut"},"[",a.a.createElement("span",{className:"shift"},"\u21e7"),"+w]")),a.a.createElement("button",{className:"button",onTouchStart:b,onClick:n},c?"Stop ":"Start ",a.a.createElement("span",{className:"button__shortcut"},"[space]")),a.a.createElement("button",{className:"button",onTouchStart:b,onClick:g},"Reset",a.a.createElement("span",{className:"button__shortcut"},"[",a.a.createElement("span",{className:"shift"},"\u21e7"),"+e]")),a.a.createElement("button",{className:"button button--mobile",onClick:function(){d(I(f))}},"Rotate 90deg",a.a.createElement("span",{className:"button__shortcut"},"[",a.a.createElement("span",{className:"shift"},"\u21e7"),"+r]")),a.a.createElement(N,{onChange:function(e){d(function(e,t){var n=t.filter((function(t){return t.name===e}))[0];return n.distanceVec=x(n),n}(e.target.value,w)),e.target.blur()},selectedBrush:f,brushesLoaded:p,brushes:w}),a.a.createElement("button",{className:"button button--desktop",onClick:function(){d(I(f))}},"Rotate 90deg",a.a.createElement("span",{className:"button__shortcut"},"[",a.a.createElement("span",{className:"shift"},"\u21e7"),"+r]")))}var M,P=function(e,t){return{x:Math.floor(e/16),y:Math.floor(t/16)}},z=function(e,t){var n=new Set,r=!0,a=!1,c=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var i=o.value;e.has(i)&&n.add(i)}}catch(u){a=!0,c=u}finally{try{r||null==s.return||s.return()}finally{if(a)throw c}}return n};function _(e){var t=e.board,n=e.windowSize,c=e.cols,o=e.rows,s=e.setBoard,i=e.setCols,u=e.setRows,l=e.brush,f=e.setHoverBoard,b=e.hoverBoard,m=e.seed,w=e.lastPaintedHoverIndices,p=e.lastPaintedIndices,g=e.setLastPaintedHoverIndices,j=e.setLastPaintedIndices,y=e.isRunning,O=Object(r.useRef)(null),E=function(e,t,n,r){var a=d(n,r),c=a.x,o=a.y;e.fillStyle=1===t?"#00adb5":"#393e46",e.fillRect(15*c+c,15*o+o,15,15)},k=function(e,t,n,r){if(1===t&&(y||w.has(n))){var a=d(n,r),c=a.x,o=a.y;e.fillStyle=p.has(n)?"rgb(200,87,125)":"rgba(238, 238, 238, 0.3)",e.fillRect(15*c+c,15*o+o,15,15)}};return Object(r.useEffect)((function(){var e=Math.floor((n.height+1)/16),r=Math.floor((n.width+1)/16);c===r&&o===e||(s(v(t,c,o,r,e)),u(e),i(r))})),Object(r.useEffect)((function(){var e=O.current.getContext("2d");!function(e){e.clearRect(0,0,n.width,n.height)}(e);for(var r=0,a=t.length;r<a;r++)E(e,t[r],r,c),k(e,b[r],r,c)})),a.a.createElement("canvas",{ref:O,width:n.width,height:n.height,onClick:function(e){if(y||0===z(w,p).size){var n=P(e.pageX,e.pageY),r=h(n,t,c,o,l),a=r.nBoard,i=r.paintedIndices;j(y?new Set:i),s(a)}},onMouseLeave:function(){return f(m)},onTouchEnd:function(e){if(M=P(e.changedTouches[0].clientX,e.changedTouches[0].clientY),y||0===z(w,p).size){var n=h(M,t,c,o,l),r=n.nBoard,a=n.paintedIndices;j(y?new Set:a),s(r)}f(m),e.preventDefault()},onTouchMove:function(e){M=P(e.touches[0].clientX,e.touches[0].clientY);var n=h(M,m,c,o,l),r=n.nBoard,a=n.paintedIndices;if(g(a),g(y?new Set:a),f(r),l.template.length<17&&(y||0===z(w,p).size)){var i=h(M,t,c,o,l),u=i.nBoard,d=i.paintedIndices;j(y?new Set:d),s(u)}},onMouseMove:function(e){M=P(e.pageX,e.pageY);var n=h(M,m,c,o,l),r=n.nBoard,a=n.paintedIndices;if(g(y?new Set:a),f(r),(1===e.buttons||3===e.buttons)&&(y||0===z(w,p).size)){var i=h(M,t,c,o,l),u=i.nBoard,d=i.paintedIndices;j(y?new Set:d),s(u)}}})}function H(e){var t=e.cols,n=e.rows,c=e.seed,o=e.windowSize,u=e.setRows,l=e.setCols,d=w(n,t,c),f=Object(s.a)(d,2),b=f[0],v=f[1],m=w(n,t,c),p=Object(s.a)(m,5),g=p[0],j=p[1],y=p[2],O=p[3],E=p[4],k=Object(r.useState)(B),S=Object(s.a)(k,2),x=S[0],C=S[1],R=Object(r.useState)(new Set),N=Object(s.a)(R,2),P=N[0],z=N[1],H=Object(r.useState)(new Set),T=Object(s.a)(H,2),A=T[0],W=T[1];i(E,y?50:null);var V=Object(r.useCallback)((function(e){C(e)}),[C]),X=Object(r.useCallback)((function(e){32!==e.keyCode&&"click"!==e.type||(z(new Set),O(!y))}),[y,O,z]),Y=Object(r.useCallback)((function(){v(c)}),[v,c]);Object(r.useEffect)((function(){return document.addEventListener("keydown",X,!1),function(){document.removeEventListener("keydown",X,!1)}}),[X]);var K=Object(r.useCallback)((function(e){if("KeyR"===e.code){V(I(x));var r=h(M,c,t,n,I(x)),a=r.nBoard,o=r.paintedIndices;W(o),v(a)}}),[V,x,c,t,n,v]);return Object(r.useEffect)((function(){return document.addEventListener("keydown",K,!1),function(){document.removeEventListener("keydown",K,!1)}}),[K]),a.a.createElement(r.Fragment,null,a.a.createElement(_,{board:g,brush:x,setBoard:j,windowSize:o,cols:t,setCols:l,setRows:u,rows:n,seed:c,setHoverBoard:v,hoverBoard:b,lastPaintedIndices:P,setLastPaintedIndices:z,lastPaintedHoverIndices:A,isRunning:y,setLastPaintedHoverIndices:W}),a.a.createElement(L,{advanceBoard:E,toggleIsRunning:X,isRunning:y,setIsRunning:O,setBoard:j,board:g,touchHoverClear:Y,setSelectedBrushWrapper:V,selectedBrush:x,setLastPaintedIndices:z,cols:t,rows:n}))}var T=function(){var e=u(),t=Object(r.useState)(Math.floor((e.height+1)/16)),n=Object(s.a)(t,2),c=n[0],o=n[1],i=Object(r.useState)(Math.floor((e.width+1)/16)),l=Object(s.a)(i,2),d=l[0],f=l[1],b=Array(c*d).fill(0);return a.a.createElement(H,{rows:c,cols:d,seed:b,windowSize:e,setRows:o,setCols:f})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,n){e.exports=n(16)}},[[8,1,2]]]);
//# sourceMappingURL=main.190334bc.chunk.js.map